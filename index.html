<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>점심 추천 슬롯</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #0b0c10;
      color: #fff;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .app {
      width: 100%;
      max-width: 420px;
      padding: 16px;
      position: relative;
    }

    .card {
      background: radial-gradient(circle at top, #2b2f4a 0%, #111322 60%, #05060a 100%);
      border-radius: 24px;
      padding: 20px 16px 16px;
      box-shadow: 0 18px 40px rgba(0, 0, 0, 0.7);
      position: relative;
      overflow: hidden;
      min-height: 420px;
    }

    .title {
      text-align: center;
      margin-bottom: 12px;
    }

    .title-main {
      font-size: 20px;
      font-weight: 700;
      letter-spacing: 0.08em;
    }

    .title-sub {
      font-size: 12px;
      opacity: 0.7;
      margin-top: 4px;
    }

    .view {
      width: 100%;
      height: calc(100% - 52px);
      position: relative;
    }
    .view.hidden {
      display: none;
    }

    /* ---------- 슬롯 화면 ---------- */

    .slot-view {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    .slot-area {
      position: relative;
      margin-top: 8px;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .wheel-wrapper {
      position: relative;
      width: 320px;
      height: 320px;
    }

    .wheel-base {
      position: absolute;
      inset: 0;
      border-radius: 50%;
      background: radial-gradient(circle, #ffffff 25%, #f5f5f5 60%, #dddddd 100%);
      box-shadow:
        inset 0 0 4px rgba(0, 0, 0, 0.3),
        0 10px 20px rgba(0, 0, 0, 0.6);
    }

    .wheel {
      position: absolute;
      inset: 12px;
      border-radius: 50%;
      border: 4px solid rgba(0, 0, 0, 0.12);
      overflow: visible;
      display: flex;
      justify-content: center;
      align-items: center;
      transition: transform 3s cubic-bezier(0.21, 0.95, 0.45, 1);
      transform: rotate(0deg);
    }

    /* 섹터 구분선 */
    .slice-divider {
      position: absolute;
      left: 50%;
      top: 50%;
      width: 50%;
      height: 2px;
      transform-origin: 0 50%;
      background: rgba(0, 0, 0, 0.18);
    }

    .slice-label {
      position: absolute;
      left: 50%;
      top: 50%;
      transform-origin: 0 0;
      width: 50%;
      font-size: 11px;
      text-align: center;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.25);
      color: #222;
    }

    .slice-label span {
      display: inline-block;
      transform: translateY(-135%);
      padding: 2px 6px;
      border-radius: 999px;
      background: rgba(255, 255, 255, 0.8);
      border: 1px solid rgba(0, 0, 0, 0.08);
      white-space: nowrap;
    }

    .pointer {
      position: absolute;
      top: 6px;
      left: 50%;
      transform: translateX(-50%);
      width: 0;
      height: 0;
      border-left: 12px solid transparent;
      border-right: 12px solid transparent;
      border-bottom: 18px solid #ffeb8a;
      filter: drop-shadow(0 0 6px rgba(0, 0, 0, 0.8));
      z-index: 3;
    }

    .center-button-wrap {
      position: absolute;
      inset: 120px;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 2;
      pointer-events: none; /* 가운데 영역 클릭 통과 */
    }

    .spin-button {
      border: none;
      outline: none;
      border-radius: 999px;
      padding: 10px 20px;
      font-size: 15px;
      font-weight: 700;
      letter-spacing: 0.08em;
      background: radial-gradient(circle at 30% 20%, #ff9b9b, #ff3b3b);
      color: #fff;
      box-shadow: 0 6px 14px rgba(0, 0, 0, 0.7);
      cursor: pointer;
      transition: transform 0.1s ease, box-shadow 0.1s ease, opacity 0.2s ease;
      pointer-events: auto; /* 버튼만 클릭 가능 */
      white-space: nowrap;
    }

    .spin-button:active {
      transform: translateY(1px) scale(0.97);
      box-shadow: 0 3px 8px rgba(0, 0, 0, 0.6);
    }

    .spin-button.disabled {
      opacity: 0.5;
      pointer-events: none;
    }

    /* ---------- 결과 화면 ---------- */

    .result-view {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 12px 8px 8px;
    }

    .result-title {
      font-size: 13px;
      opacity: 0.8;
      margin-bottom: 4px;
    }

    .result-main {
      font-size: 18px;
      font-weight: 700;
      margin-bottom: 14px;
      line-height: 1.4;
    }

    .result-character-box {
      width: 160px;
      height: 160px;
      border-radius: 26px;
      background: linear-gradient(135deg, #ff7bc2, #7f7bff);
      overflow: hidden;
      position: relative;
      margin-bottom: 12px;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 12px;
      padding: 6px;
    }

    .result-character-box img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    .result-char-name {
      position: absolute;
      bottom: 6px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 11px;
      padding: 3px 8px;
      border-radius: 999px;
      background: rgba(0, 0, 0, 0.7);
      white-space: nowrap;
    }

    .result-line {
      font-size: 13px;
      opacity: 0.9;
      line-height: 1.6;
      margin-bottom: 16px;
      padding: 0 8px;
    }

    .result-retry-button {
      border: none;
      outline: none;
      border-radius: 999px;
      padding: 8px 18px;
      font-size: 13px;
      font-weight: 600;
      letter-spacing: 0.04em;
      background: rgba(255, 204, 92, 0.16);
      color: #ffd86b;
      border: 1px solid rgba(255, 216, 107, 0.6);
      cursor: pointer;
      transition: background 0.15s ease, transform 0.1s ease;
    }

    .result-retry-button:active {
      transform: translateY(1px);
      background: rgba(255, 204, 92, 0.26);
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(6px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .result-view.fade-in {
      animation: fadeInUp 0.35s ease forwards;
    }

    @media (max-width: 360px) {
      .wheel-wrapper {
        width: 280px;
        height: 280px;
      }
      .center-button-wrap {
        inset: 106px;
      }
      .spin-button {
        font-size: 14px;
        padding: 9px 18px;
      }
      .result-main {
        font-size: 16px;
      }
      .result-character-box {
        width: 140px;
        height: 140px;
      }
    }
  </style>
</head>
<body>
  <div class="app">
    <div class="card">
      <div class="title">
        <div class="title-main">LUNCH SLOT</div>
        <div class="title-sub">오늘 점심 메뉴는 실험체에게 맡겨보자</div>
      </div>

      <!-- 슬롯 화면 -->
      <div class="view slot-view" id="slotView">
        <div class="slot-area">
          <div class="wheel-wrapper">
            <div class="wheel-base"></div>

            <div class="wheel" id="wheel">
              <!-- 구분선 & 라벨은 JS에서 동적 생성 -->
            </div>

            <div class="pointer"></div>

            <div class="center-button-wrap">
              <button class="spin-button" id="spinButton">
                점심 추천
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- 결과 화면 -->
      <div class="view result-view hidden" id="resultView">
        <div class="result-title">오늘의 점심 결과</div>
        <div class="result-main" id="resultMainText"></div>

        <div class="result-character-box" id="resultCharacterBox">
          <span>캐릭터 프리뷰</span>
          <div class="result-char-name" id="resultCharName">???</div>
        </div>

        <div class="result-line" id="resultLine"></div>

        <button class="result-retry-button" id="resultRetryButton">
          메뉴 다시 추천
        </button>
      </div>
    </div>
  </div>

  <script>
    // 1. 데이터 정의
    const CATEGORY_DATA = [
      {
        id: 0,
        key: "riceThief",
        label: "밥도둑",
        character: {
          name: "비앙카",
          image: "이미지/비앙카.jpg",
          line: "진조가 추천하는 메뉴인것이다!"
        },
        menus: [
          "찜닭", "아구찜", "오므라이스", "제육",
          "덮밥", "카레라이스", "생선정식", "게장"
        ]
      },
      {
        id: 1,
        key: "noodle",
        label: "면류",
        character: {
          name: "피오라",
          image: "이미지/피오라.jpg",
          line: "밥 먹는 것도 중요하지."
        },
        menus: [
          "비빔국수", "스파게티", "잔치국수", "뇨끼",
          "칼국수", "수제비", "쌀국수", "막국수"
        ]
      },
      {
        id: 2,
        key: "japanese",
        label: "일식",
        character: {
          name: "리오",
          image: "이미지/리오.jpg",
          line: "오늘은 이 메뉴를 추천합니다."
        },
        menus: [
          "초밥", "가츠동", "라멘", "소바",
          "돈부리", "규동", "오코노미야끼", "연어덮밥"
        ]
      },
      {
        id: 3,
        key: "soup",
        label: "국/찌개",
        character: {
          name: "현우",
          image: "이미지/현우.jpg",
          line: "이럴 때 먹으라고 있는 게 이 메뉴지."
        },
        menus: [
          "김치찌개", "육개장", "뼈해장국", "부대찌개",
          "된장찌개", "돼지국밥", "갈치조림", "순두부찌개"
        ]
      },
      {
        id: 4,
        key: "chinese",
        label: "중식",
        character: {
          name: "쇼우",
          image: "이미지/쇼우.jpg",
          line: "좋아! 내가 단숨에 요리해줄게."
        },
        menus: [
          "마라탕", "짜장면", "짬뽕", "탕수육",
          "깐풍새우", "새우볶음밥", "마파두부", "꿔바로우"
        ]
      },
      {
        id: 5,
        key: "lazy",
        label: "귀찮음",
        character: {
          name: "일레븐",
          image: "이미지/일레븐.jpg",
          line: "모두 안녕? 오늘은 이 메뉴를 추천할게."
        },
        menus: [
          "토스트", "볶음밥", "샌드위치", "도시락",
          "타코", "컵라면", "삼각김밥", "햄버거"
        ]
      },
      {
        id: 6,
        key: "heavy",
        label: "헤비",
        character: {
          name: "유키",
          image: "이미지/유키.jpg",
          line: "이 메뉴 추천은 어떠십니까?"
        },
        menus: [
          "치킨", "족발", "보쌈", "피자",
          "곱창", "삼겹살", "스테이크", "닭발"
        ]
      },
      {
        id: 7,
        key: "snack",
        label: "분식",
        character: {
          name: "레니",
          image: "이미지/레니.jpg",
          line: "띠용~ 띠용~"
        },
        menus: [
          "떡볶이", "어묵", "순대", "김밥",
          "돈까스", "라면", "핫도그", "튀김"
        ]
      }
    ];

    const wheelEl = document.getElementById("wheel");
    const spinButton = document.getElementById("spinButton");
    const slotView = document.getElementById("slotView");
    const resultView = document.getElementById("resultView");
    const resultMainText = document.getElementById("resultMainText");
    const resultLine = document.getElementById("resultLine");
    const resultCharName = document.getElementById("resultCharName");
    const resultCharacterBox = document.getElementById("resultCharacterBox");
    const resultRetryButton = document.getElementById("resultRetryButton");

    const sliceDeg = 360 / CATEGORY_DATA.length; // 45도
    let isSpinning = false;

    // 2. 슬롯 라벨 & 구분선 세팅
    function setupWheel() {
      CATEGORY_DATA.forEach((cat, index) => {
        const angleCenter = sliceDeg * index + sliceDeg / 2;

        // 구분선
        const divider = document.createElement("div");
        divider.className = "slice-divider";
        divider.style.transform = `rotate(${sliceDeg * index}deg)`;
        wheelEl.appendChild(divider);

        // 라벨
        const label = document.createElement("div");
        label.className = "slice-label";
        label.style.transform = `rotate(${angleCenter}deg) translate(0, -50%)`;
        label.innerHTML = `<span>${cat.label}</span>`;
        wheelEl.appendChild(label);
      });
    }

    setupWheel();

    // 3. 랜덤 선택
    function pickRandomCategoryAndMenu() {
      const category =
        CATEGORY_DATA[Math.floor(Math.random() * CATEGORY_DATA.length)];
      const menu =
        category.menus[Math.floor(Math.random() * category.menus.length)];
      return { category, menu };
    }

    // 4. 결과 화면 표시 (카테고리 텍스트는 화면에 안 보이게)
    function showResultScreen(category, menu) {
      resultMainText.textContent = `오늘 점심은 "${menu}" 어때?`;
      resultLine.textContent = category.character.line;
      resultCharName.textContent = category.character.name || "???";

      const oldImg = resultCharacterBox.querySelector("img");
      const placeholderText = resultCharacterBox.querySelector("span");

      if (category.character.image) {
        if (!oldImg) {
          const img = document.createElement("img");
          img.src = category.character.image;
          img.alt = category.character.name || "캐릭터";
          resultCharacterBox.insertBefore(img, placeholderText);
        } else {
          oldImg.src = category.character.image;
          oldImg.alt = category.character.name || "캐릭터";
        }
        if (placeholderText) {
          placeholderText.style.display = "none";
        }
      } else {
        if (oldImg) oldImg.remove();
        if (placeholderText) {
          placeholderText.style.display = "block";
          placeholderText.textContent = "캐릭터 프리뷰";
        }
      }

      slotView.classList.add("hidden");
      resultView.classList.remove("hidden");
      resultView.classList.remove("fade-in");
      // 강제 리플로우 후 애니메이션 클래스 추가
      void resultView.offsetWidth;
      resultView.classList.add("fade-in");
    }

    function showSlotScreen() {
      resultView.classList.add("hidden");
      slotView.classList.remove("hidden");
    }

    // 5. 회전 + 화면 전환
    function spin() {
      if (isSpinning) return;
      isSpinning = true;
      spinButton.classList.add("disabled");

      showSlotScreen(); // 항상 슬롯 화면에서 시작

      const { category, menu } = pickRandomCategoryAndMenu();
      const targetIndex = category.id;

      const randomTurns = 5 + Math.floor(Math.random() * 3); // 5~7바퀴
      const targetAngle = targetIndex * sliceDeg + sliceDeg / 2;
      const finalRotation = randomTurns * 360 - targetAngle;

      wheelEl.style.transition = "transform 3s cubic-bezier(0.21, 0.95, 0.45, 1)";
      wheelEl.style.transform = `rotate(${finalRotation}deg)`;

      setTimeout(() => {
        showResultScreen(category, menu);
        isSpinning = false;
        spinButton.classList.remove("disabled");
      }, 3100);
    }

    // 6. 이벤트
    spinButton.addEventListener("click", spin);
    resultRetryButton.addEventListener("click", spin);
  </script>
</body>
</html>

